{{extend 'layout.html'}}
<head>
  <title> PicLocal </title>
  <!--<link rel="stylesheet" href="{{=URL('static','css/main.css')}}"/>-->
  <link rel="stylesheet" href="{{=URL('static','css/index.css')}}"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"> 

{{block head}}
<script src="{{=URL('static', 'js/vue.js')}}"></script>
<script>
    var add_post_url = "{{=URL('api', 'add_post', user_signature=True)}}";
    var get_post_list_url = "{{=URL('api', 'get_post_list')}}";
    // Like callbacks.
    var set_like_url = "{{=URL('api', 'set_like', user_signature=True)}}";
    var get_likers_url = "{{=URL('api', 'get_likers')}}"
    // Comments.
    var getCommentsUrl = "{{=URL('api', 'get_comments')}}";
    var insertCommentsUrl = "{{=URL('api', 'insert_comment', user_signature=True)}}";
    var edit_post_url = "{{=URL('api', 'edit_post', user_signature=True)}}";
    var edit_comment_url = "{{=URL('api', 'edit_comment', user_signature=True)}}";
<<<<<<< HEAD
    var get_thumb_count_url = "{{=URL('api', 'get_thumb_count_on_post')}}";
    var set_thumb_url = "{{=URL('api', 'set_thumb', user_signature=True)}}";
=======
    // Images.
    var image_post_url = "{{=URL('api', 'post_image')}}";
    var image_get_url = "{{=URL('api', 'get_image')}}";
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
    // Stars.
    var set_stars_url = "{{=URL('api', 'set_stars', user_signature=True)}}";
    var is_logged_in = "{{=URL('api', 'logged_in')}}";
</script>
{{end}}
</head>

<body>

  <!-- TODO: Currently covers the web2py ui.-->
  <header>
    <navbar>
    <a href="{{=URL('default', 'index')}}"> <i class="fa fa-home" aria-hidden="true"></i></a>
    </navbar>
    <navbar>
    <a href="search.html"> <i class="fa fa-search" aria-hidden="true"></i></a>
  </navbar>
  <navbar>
    <a href="likes.html"> <i class="fa fa-heart-o" aria-hidden="true"></i></a>
  </navbar>
  <navbar>
    <a href="{{=URL('default', 'profile')}}"><i class="fa fa-user-o" aria-hidden="true"></i></a>
  </navbar>
  </header>

  <div class="main_content">

    <div id="vue-div">
    <div id="pleaseLogIn" v-if="!loggedIn">
      Please <a href="{{=URL('default', 'user/login')}}">Sign In</a>
      or <a href="{{=URL('default', 'user/register')}}">Register</a>
    </div>
    <div id="login" v-if="loggedIn">
    <button id="form_appear" v-if="!showForm " v-on:click="toggle_form()">Add Post</button>
      <div id="add_post" v-if="showForm">
        <div class="container form_row">
          <div class="label quarter">
            Title:
          </div>
          <div class="form threequarters">
            <input v-model="form_title" placeholder="Enter the post title"/>
          </div>
        </div>
        <div class="container form_row">
          <div class="label quarter">
            Content:
          </div>
          <div class="form threequarters">
            <textarea v-model="form_content" placeholder="Enter the content of your post"></textarea>
          </div>
        </div>
        <div class="container form_row">
          <div class="label quarter">
            Location:
          </div>
          <div class="form half">
            Latitude: <textarea v-model="form_lat" placeholder=""></textarea>
          </div>
          <div class="form half">
            Longitude: <textarea v-model="form_long" placeholder=""></textarea>
          </div>
        </div>
        <div class="container form_row">
            <div id="uploader_div">
                <!--Upload an image file: <input id="file_input" type="file" v-on:change="upload_file($event, 1)" accept="image/jpeg">-->
                Upload an image file: <input id="file_input" type="file" v-on:change="update_file($event)" accept="image/jpeg">
              </div>
        </div>
        <div class="container form_row"><div class="quarter"></div>
          <div class="threequarters">
            <div class="submit">
              <button id="add-post" v-on:click="add_post">Submit</button>
              <button id="cancel-post" v-on:click="toggle_form()">Cancel</button>
            </div>
          </div>
        </div>
<<<<<<< HEAD
        </div>
        <div v-if="post_list.length === 0">There are no posts.</div>
      </div>
      

        <!-- This is hw4 code that I am keeping commented for reference.-->

      <!-- Message in case there are no posts. -->
      
<!--
      <!-- We display the posts. 
=======
      <!-- Message in case there are no posts. -->
      <div v-if="post_list.length === 0">There are no posts.</div>
    </div>
    
    <div class="container">
      <!-- We display the posts. -->
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
      <div id="post_list">
        <div class="card" v-for="post in post_list">
          <div class="card-header">
            <div class="profile-img">
              <!-- Code for profile picture goes here. -->
            </div>
            <div class ="profile-info">
              <div class="name">${post.post_author}</div>
              <div class ="location">Santa Cruz, California </div>  <!-- Change this to ${post.post_location?}-->
            </div>
            <div class="time">
              ${post.post_date}  <!-- not displaying for some reason? -->
            </div>
          </div>

            <div class="content">
              <!-- <img src="{{=URL('static','images/nature.png')}}" />  <!-- Change this to {$post.post_image} once we have image posting done?-->    
              <img v-bind:src="post.post_image" />
            </div>      
        
            <div class="card-footer">
              <div class="likes">
                21 likes    <!-- I don't have the code for likes in my hw. Does someone else have it? -->
              </div>
              <div class="description"> 
                <p>
                  <span class="username">${post.post_author}</span> ${post.post_content} <!-- Responsible for the caption for the photo. -->
                </p>
              </div>
              <div class="comments">
                <button v-if="!post.showComments" v-on:click="showComments(post._idx)">Add / Show Comments</button>
                <button v-if="post.showComments" v-on:click="hideComments(post._idx)">Hide Comments</button>
                <div v-if="post.showComments" class="comment-section">
                  <br>
                  <button v-if="!post.addingComment" v-on:click="toggleAddingComment(post._idx)">Add Comment</button>
                  <div v-if="post.addingComment">
                    <textarea v-model="post.newComment"></textarea>
                    <button v-on:click="saveComment(post._idx); toggleAddingComment(post._idx);">Save</button>
                  </div>
                  <div v-if="post.comments.length > 0" v-for="(comment, index) in post.comments" class="comment">
                    <p>
                      <span class="username">
                        ${ comment.comment_author } 
                      </span>
                      ${ comment.body }
                    </p>
                    <button v-if="!comment.editingComment" v-on:click="toggleEditingComment(post._idx, index)"> <i class="fa fa-pencil-square-o"></i> Edit Comment </button>
                    <div v-if="comment.editingComment">
                      <textarea v-model="comment.body"></textarea>
                      <button v-on:click="edit_comment(post._idx, index); toggleEditingComment(post._idx, index);">Save Comment</button>
                    </div>
<<<<<<< HEAD
                </div>

          </div>
        </div>
      </div>

    -->

<div class="container">
    <!-- We display the posts. -->
      <div id="post_list">
        <div class="card" v-for="post in post_list">

              <div class="card-header">
                <div class="profile-img">
      
                </div>
                  <div class ="profile-info">
                    <div class="name">${post.post_author}</div>
                    <span>
                      <div class="location">${post.post_lat}, ${post.post_long}</div>  <!-- Change this to ${post.post_location?}-->
                    </span>
=======
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
                  </div>
                  <div v-if="post.comments.length <= 0">
                      This post has no comments.
                  </div>
<<<<<<< HEAD
              </div>
      
              <div class="content">
                <img src="{{=URL('static','images/nature.png')}}" />  <!-- Change this to {$post.post_image} once we have image posting done?-->
              </div>
      
              <div class="card-footer">
                <div class="likes">
                  likes: ${post.thumb_count}    <!-- I don't have the code for likes in my hw. Does someone else have it? -->
=======
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
                </div>
              </div>
              <hr />
              <form>
                <!-- Like button. Implement hover similar to the thumbs in hw3? -->
                <div class="heart">
                  <i class="fa fa-heart-o" aria-hidden="true"></i>
                </div>
                <div class="add-comment">
                  <input type="text" placeholder="Add comment."/>
                </div>
                <div class="options">
                    <i class="fa fa-ellipsis-h" aria-hidden="true"></i>
                </div>
<<<<<<< HEAD
                <hr />
                <form>
                <!---  <div class="heart">
                      <i class="fa fa-heart-o" aria-hidden="true"></i>
                  </div> -->
                  <span v-on:mouseover="thumb_mouseover(post._idx, 'u')" v-on:mouseout="thumb_mouseout(post._idx)">
                      <i v-if="post._thumb_state == 'u'" v-on:click="thumb_click(post._idx,'u')"  class="fa thumbshover fa-thumbs-up"></i>
                      <i v-if="post._thumb_state !='u'" v-on:click="thumb_click(post._idx,'u')" class="fa fa-thumbs-o-up"></i>
                      </span>
                    <span v-on:mouseover="thumb_mouseover(post._idx, 'd')" v-on:mouseout="thumb_mouseout(post._idx)">
                      <i v-if="post._thumb_state !='d'" v-on:click="thumb_click(post._idx,'d')" class="fa fa-thumbs-o-down"></i>
                      <i v-if="post._thumb_state =='d'" v-on:click="thumb_click(post._idx,'d')" class="fa thumbshover fa-thumbs-down"></i>
                    </span>
      
                  <div class="add-comment">
                    <input type="text" placeholder="Add comment."/>
                  </div>
      
                  <div class="options">
                      <i class="fa fa-ellipsis-h" aria-hidden="true"></i>
                  </div>
                </form>
              </div>
=======
              </form>
            </div>
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
          </div>
        </div>
      </div>
    </div>
<<<<<<< HEAD
</div>
</div>

=======
  </div>
>>>>>>> c8cd6ee30bf07ee7752380f5d0426565e72b9d38
</body>

<script src="{{=URL('static', 'js/default_index.js')}}"></script>



